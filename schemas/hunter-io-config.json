{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Hunter.io API Configuration - Enhanced Email Intelligence",
  "description": "Comprehensive configuration schema for Hunter.io integration with email verification and domain intelligence",
  "type": "object",
  "properties": {
    "authentication": {
      "type": "object",
      "properties": {
        "api_key": {
          "type": "string",
          "description": "Hunter.io API key"
        },
        "rate_limits": {
          "type": "object",
          "properties": {
            "requests_per_minute": {"type": "integer", "default": 25},
            "requests_per_month": {"type": "integer", "default": 1000},
            "searches_per_month": {"type": "integer", "default": 500}
          }
        }
      },
      "required": ["api_key"]
    },
    "email_finder": {
      "type": "object",
      "properties": {
        "enable_email_finder": {
          "type": "boolean",
          "default": true,
          "description": "Use Hunter to find email addresses"
        },
        "confidence_threshold": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "default": 70,
          "description": "Minimum confidence score for email addresses"
        },
        "include_patterns": {
          "type": "boolean",
          "default": true,
          "description": "Include email patterns in results"
        }
      }
    },
    "email_verification": {
      "type": "object",
      "properties": {
        "enable_verification": {
          "type": "boolean",
          "default": true,
          "description": "Verify email addresses"
        },
        "verification_levels": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["deliverable", "undeliverable", "risky", "unknown"]
          },
          "default": ["deliverable", "risky"]
        },
        "smtp_check": {
          "type": "boolean",
          "default": true,
          "description": "Perform SMTP validation"
        }
      }
    },
    "domain_search": {
      "type": "object",
      "properties": {
        "enable_domain_search": {
          "type": "boolean",
          "default": true,
          "description": "Search for emails by domain"
        },
        "include_generic": {
          "type": "boolean",
          "default": false,
          "description": "Include generic email addresses"
        },
        "seniority_filter": {
          "type": "array",
          "items": {"type": "string"},
          "default": ["senior", "executive", "director"]
        },
        "department_filter": {
          "type": "array",
          "items": {"type": "string"},
          "default": ["information_technology", "marketing", "sales"]
        }
      }
    },
    "halopsa_field_mapping": {
      "type": "object",
      "properties": {
        "lead_fields": {
          "type": "object",
          "properties": {
            "CF_101_source_platform": {"const": "Hunter.io"},
            "CF_102_confidence_score": {
              "description": "Hunter email confidence score"
            },
            "CF_103_company_size": {
              "description": "Estimated company size from domain data"
            },
            "CF_104_industry": {
              "description": "Industry from domain patterns"
            },
            "CF_106_contact_seniority": {
              "description": "Seniority level from email pattern"
            },
            "CF_107_technologies_used": {
              "description": "Web technologies detected"
            },
            "CF_112_data_freshness": {
              "description": "Email verification date"
            },
            "CF_113_contact_reachability": {
              "description": "Email deliverability status"
            }
          }
        }
      }
    },
    "data_enrichment": {
      "type": "object",
      "properties": {
        "include_social_profiles": {
          "type": "boolean",
          "default": true,
          "description": "Include social media profiles when available"
        },
        "include_phone_numbers": {
          "type": "boolean",
          "default": false,
          "description": "Include phone numbers (limited availability)"
        },
        "include_job_titles": {
          "type": "boolean",
          "default": true,
          "description": "Include job titles when detected"
        }
      }
    },
    "webhooks": {
      "type": "object",
      "properties": {
        "webhook_url": {
          "type": "string",
          "format": "uri"
        },
        "events": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "email_found",
              "email_verified",
              "domain_searched",
              "verification_completed"
            ]
          }
        }
      }
    },
    "email_patterns": {
      "type": "object",
      "properties": {
        "pattern_confidence_threshold": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "default": 80
        },
        "use_patterns_for_prediction": {
          "type": "boolean",
          "default": true,
          "description": "Use email patterns to predict email addresses"
        },
        "validate_predicted_emails": {
          "type": "boolean",
          "default": true,
          "description": "Verify predicted email addresses"
        }
      }
    },
    "bi_directional_sync": {
      "type": "object",
      "properties": {
        "enable_bounce_feedback": {
          "type": "boolean",
          "default": true,
          "description": "Report email bounces back to Hunter"
        },
        "enable_deliverability_feedback": {
          "type": "boolean",
          "default": true,
          "description": "Share email deliverability data"
        }
      }
    },
    "cost_optimization": {
      "type": "object",
      "properties": {
        "cache_results": {
          "type": "boolean",
          "default": true,
          "description": "Cache email verification results"
        },
        "cache_duration_days": {
          "type": "integer",
          "default": 30,
          "description": "How long to cache results"
        },
        "skip_reverification_days": {
          "type": "integer",
          "default": 7,
          "description": "Days to wait before re-verifying same email"
        }
      }
    }
  },
  "required": ["authentication", "halopsa_field_mapping"]
}
  "properties": {
    "api_config": {
      "type": "object",
      "properties": {
        "base_url": {
          "type": "string",
          "default": "https://api.hunter.io/v2"
        },
        "authentication": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["api_key"],
              "default": "api_key"
            },
            "api_key": {
              "type": "string",
              "description": "Hunter.io API key"
            },
            "param_name": {
              "type": "string",
              "default": "api_key",
              "description": "Parameter name for API key in query string"
            }
          },
          "required": ["type", "api_key"]
        },
        "rate_limits": {
          "type": "object",
          "properties": {
            "requests_per_second": {
              "type": "integer",
              "default": 10
            },
            "monthly_quota": {
              "type": "object",
              "properties": {
                "free": {
                  "type": "integer",
                  "default": 25
                },
                "starter": {
                  "type": "integer", 
                  "default": 1000
                },
                "growth": {
                  "type": "integer",
                  "default": 5000
                },
                "business": {
                  "type": "integer",
                  "default": 20000
                }
              }
            }
          }
        },
        "endpoints": {
          "type": "object",
          "properties": {
            "domain_search": {
              "type": "object",
              "properties": {
                "method": {
                  "type": "string",
                  "enum": ["GET"],
                  "default": "GET"
                },
                "path": {
                  "type": "string",
                  "default": "/domain-search"
                },
                "description": "Find email addresses from a domain name"
              }
            },
            "email_finder": {
              "type": "object",
              "properties": {
                "method": {
                  "type": "string",
                  "enum": ["GET"],
                  "default": "GET"
                },
                "path": {
                  "type": "string",
                  "default": "/email-finder"
                },
                "description": "Find email address for a specific person"
              }
            },
            "email_verifier": {
              "type": "object",
              "properties": {
                "method": {
                  "type": "string",
                  "enum": ["GET"],
                  "default": "GET"
                },
                "path": {
                  "type": "string",
                  "default": "/email-verifier"
                },
                "description": "Verify email address validity"
              }
            },
            "account_info": {
              "type": "object",
              "properties": {
                "method": {
                  "type": "string",
                  "enum": ["GET"],
                  "default": "GET"
                },
                "path": {
                  "type": "string",
                  "default": "/account"
                },
                "description": "Get account information and usage"
              }
            }
          }
        }
      }
    },
    "query_templates": {
      "type": "object",
      "properties": {
        "domain_search": {
          "type": "object",
          "properties": {
            "domain": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$",
              "description": "Domain name to search (e.g., company.com)"
            },
            "type": {
              "type": "string",
              "enum": ["personal", "generic"],
              "description": "Type of emails to return"
            },
            "limit": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 25,
              "description": "Maximum number of emails to return"
            },
            "offset": {
              "type": "integer",
              "minimum": 0,
              "default": 0,
              "description": "Number of emails to skip"
            },
            "department": {
              "type": "string",
              "enum": ["executive", "it", "finance", "management", "sales", "legal", "support", "hr", "marketing", "communication"],
              "description": "Department filter"
            },
            "seniority": {
              "type": "string",
              "enum": ["junior", "senior", "executive"],
              "description": "Seniority level filter"
            }
          },
          "required": ["domain"]
        },
        "email_finder": {
          "type": "object",
          "properties": {
            "domain": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
            },
            "first_name": {
              "type": "string",
              "minLength": 1
            },
            "last_name": {
              "type": "string",
              "minLength": 1
            },
            "full_name": {
              "type": "string",
              "description": "Alternative to first_name + last_name"
            },
            "company": {
              "type": "string",
              "description": "Company name (optional, improves accuracy)"
            }
          },
          "required": ["domain"],
          "anyOf": [
            {
              "required": ["first_name", "last_name"]
            },
            {
              "required": ["full_name"]
            }
          ]
        },
        "email_verification": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "format": "email"
            }
          },
          "required": ["email"]
        }
      }
    },
    "response_schemas": {
      "type": "object",
      "properties": {
        "domain_search_response": {
          "type": "object",
          "properties": {
            "data": {
              "type": "object",
              "properties": {
                "domain": {
                  "type": "string"
                },
                "disposable": {
                  "type": "boolean"
                },
                "webmail": {
                  "type": "boolean"
                },
                "pattern": {
                  "type": "string"
                },
                "organization": {
                  "type": "string"
                },
                "emails": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "value": {
                        "type": "string",
                        "format": "email"
                      },
                      "type": {
                        "type": "string",
                        "enum": ["personal", "generic"]
                      },
                      "confidence": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 100
                      },
                      "first_name": {
                        "type": "string"
                      },
                      "last_name": {
                        "type": "string"
                      },
                      "position": {
                        "type": "string"
                      },
                      "seniority": {
                        "type": "string"
                      },
                      "department": {
                        "type": "string"
                      },
                      "linkedin": {
                        "type": "string"
                      },
                      "twitter": {
                        "type": "string"
                      },
                      "phone_number": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            },
            "meta": {
              "type": "object",
              "properties": {
                "results": {
                  "type": "integer"
                },
                "limit": {
                  "type": "integer"
                },
                "offset": {
                  "type": "integer"
                },
                "params": {
                  "type": "object"
                },
                "requests": {
                  "type": "object",
                  "properties": {
                    "used": {
                      "type": "integer"
                    },
                    "available": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "field_mappings": {
      "type": "object",
      "properties": {
        "hunter_to_halopsa_contact": {
          "type": "object",
          "properties": {
            "firstname": {
              "type": "string",
              "hunter_field": "first_name"
            },
            "surname": {
              "type": "string",
              "hunter_field": "last_name"
            },
            "emailaddress": {
              "type": "string",
              "hunter_field": "value"
            },
            "jobtitle": {
              "type": "string", 
              "hunter_field": "position"
            },
            "phonenumber": {
              "type": "string",
              "hunter_field": "phone_number"
            },
            "linkedin_url": {
              "type": "string",
              "hunter_field": "linkedin"
            },
            "twitter_handle": {
              "type": "string",
              "hunter_field": "twitter"
            },
            "notes": {
              "type": "string",
              "template": "Found via Hunter.io domain search. Confidence: {{confidence}}%, Department: {{department}}, Seniority: {{seniority}}"
            }
          }
        },
        "domain_to_halopsa_org": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "hunter_field": "organization"
            },
            "website": {
              "type": "string",
              "hunter_field": "domain",
              "transformation": "add_https_prefix"
            },
            "notes": {
              "type": "string",
              "template": "Domain analyzed via Hunter.io. Pattern: {{pattern}}, Webmail: {{webmail}}, Disposable: {{disposable}}"
            }
          }
        }
      }
    },
    "data_quality": {
      "type": "object",
      "properties": {
        "confidence_thresholds": {
          "type": "object",
          "properties": {
            "minimum_acceptable": {
              "type": "integer",
              "default": 70,
              "description": "Minimum confidence score to import contact"
            },
            "high_quality": {
              "type": "integer",
              "default": 90,
              "description": "Confidence threshold for high-quality leads"
            }
          }
        },
        "email_verification": {
          "type": "object",
          "properties": {
            "verify_before_import": {
              "type": "boolean",
              "default": true,
              "description": "Verify email addresses before importing"
            },
            "accepted_statuses": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["valid", "accept_all", "unknown"]
              },
              "default": ["valid", "accept_all"],
              "description": "Email verification statuses to accept"
            }
          }
        },
        "filtering_rules": {
          "type": "object",
          "properties": {
            "exclude_generic": {
              "type": "boolean",
              "default": true,
              "description": "Exclude generic emails (info@, sales@, etc.)"
            },
            "exclude_role_based": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["noreply", "no-reply", "donotreply", "postmaster", "abuse"],
              "description": "Role-based email prefixes to exclude"
            },
            "min_confidence_by_seniority": {
              "type": "object",
              "properties": {
                "junior": {
                  "type": "integer",
                  "default": 80
                },
                "senior": {
                  "type": "integer",
                  "default": 70
                },
                "executive": {
                  "type": "integer",
                  "default": 60
                }
              }
            }
          }
        }
      }
    }
  },
  "required": ["api_config", "query_templates", "field_mappings"]
}